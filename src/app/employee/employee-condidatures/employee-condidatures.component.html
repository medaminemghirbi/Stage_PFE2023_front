<div class="layout-wrapper layout-content-navbar">
    <div class="layout-container">
        <div class="layout-page">
            <app-employee-header></app-employee-header>
            <ng-progress #progressBar></ng-progress>
            <div class="content-wrapper">
                <div class="container-xxl flex-grow-1 container-p-y">
                    <div class="container-xxl flex-grow-1 container-p-y">
                        <!-- Main Content -->
                        <div class="card">
                            <h5 class="card-header">Candidatures Job Offers ({{counter}})</h5>
                            <h5 style="color: red;">Note : If  interview Date is Fixed you have averge of 10 min max to access the interview room .</h5>

                            <div class="table-responsive text-nowrap">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th class="border-top-0">Status</th>
                                            <th class="border-top-0">Job Title</th>
                                            <th colspan="2" class="border-top-0">Job Description</th>
                                            <th class="border-top-0">Offre Location</th>
                                            <th class="border-top-0">Offre Strat Date</th>
                                            <th class="border-top-0">Offre Contract Type</th>
                                            <th class="border-top-0">postulation date</th>
                                            <th class="border-top-0">Interview date</th>
                                            <th class="border-top-0">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody class="table-border-bottom-0">

                                        <tr
                                            *ngFor="let item of dataArray  | paginate: { itemsPerPage: 5, currentPage: p }  ">
                                           <td >
                                                <span *ngIf="item.etat == 'Interview'"
                                                    class="badge bg-label-info me-1">{{item.etat}}</span>
                                                <span *ngIf="item.etat == 'Accepted'"
                                                    class="badge bg-label-success me-1">{{item.etat}}</span>
                                                <span *ngIf="item.etat == 'Refused'"
                                                    class="badge bg-label-danger me-1">{{item.etat}}</span>
                                                <span *ngIf="item.etat == 'Encours'"
                                                    class="badge bg-label-warning me-1">{{item.etat}}</span>

                                            </td>


                                            <td>{{item.offre.titre_offre}}</td>
                                            <td colspan="2">
                                                <div class="offer-description">{{item.offre.description}}</div>
                                            </td>
                                            <td>{{item.offre.location}}</td>
                                            <td>{{item.offre.start_date}}</td>
                                            <td>{{item.offre.type_contrat}}</td>
                                            <td>{{item.date_postulation}}</td>
                                            <td>
                                                <span *ngIf="item.formatted_created_at && !(item.etat == 'Accepted')">{{item.formatted_created_at}}</span>
                                                    <span style="text-align: center;"
                                                    *ngIf="item.etat == 'Accepted'  ">
                                                    <p style="color: green;" popover="You already passed the interview " [popoverOnHover]="true">
                                                        <i class='bx bxs-checkbox-checked' ></i>
                                                    </p>
                                                    </span>

                                                    <span style="text-align: center;"
                                                    *ngIf="item.etat == 'Refused' && !(item.formatted_created_at)   ">
                                                    <p style="color: red;" popover="You already passed the interview " [popoverOnHover]="true">
                                                        <i class='bx bxs-checkbox-checked' ></i>
                                                    </p>
                                                    </span>
                                            </td>


                                            <td>

                                                <button type="button" class="btn p-0 dropdown-toggle hide-arrow"
                                                    data-bs-toggle="dropdown">
                                                    <i class="bx bx-dots-vertical-rounded"></i>
                                                </button>
                                                <div class="dropdown-menu">

                                                    <a  *ngIf="!(item.etat == 'Refused')" class="dropdown-item" (click)="navigateToInterview(item.offre.user_id, item.id, item.offre.id, item.formatted_created_at)"><i class='bx bxs-pointer'></i>
                                                    Go Interview Section</a>
                                                    <div *ngIf="item.etat == 'Refused'">
                                                        <a class="dropdown-item" href="javascript:void(0);"
                                                            (click)="deleteCandJob(item.id)">
                                                            <i class="bx bx-trash me-1"></i>Delete
                                                        </a>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr *ngIf="dataArray.length === 0">
                                            <td colspan="9">
                                                <div class="empty-table-message">No Data Found</div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>


                                <div style="text-align:right;">
                                    <pagination-controls (pageChange)="p = $event"></pagination-controls>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
